
{% extends "base.html" %}
{% block title %}Dashboard - Quantum{% endblock %}

{% block content %}
<div class="space-y-6 fade-in">
  <!-- Welcome Header -->
  <div class="card p-6">
    <div class="flex flex-col md:flex-row items-start justify-between">
      <div class="flex items-center space-x-4 mb-4 md:mb-0">
        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center">
          <span class="text-2xl font-semibold text-white">{{ current_user.first_name[0] }}{{ current_user.last_name[0] }}</span>
        </div>
        <div>
          <h1 class="text-2xl font-normal text-gray-900">
            Welcome back, <span class="font-medium text-primary">{{ current_user.first_name }}</span>
          </h1>
          <p class="text-secondary">Manage your business reviews and settings</p>
        </div>
      </div>
      
      <div class="flex items-center space-x-3">
        <div class="flex items-center space-x-2 px-3 py-1 bg-green-50 rounded-full">
          <div class="w-2 h-2 bg-success rounded-full"></div>
          <span class="text-sm text-success font-medium">Online</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Stats -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
    <div class="card p-6">
      <div class="flex items-center justify-between mb-4">
        <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-star text-primary text-lg"></i>
        </div>
        <span class="text-sm font-medium text-success">+12.5%</span>
      </div>
      <h3 class="text-2xl font-semibold text-gray-900 mb-1">4.8</h3>
      <p class="text-secondary text-sm">Average Rating</p>
    </div>
    
    <div class="card p-6">
      <div class="flex items-center justify-between mb-4">
        <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-chart-line text-success text-lg"></i>
        </div>
        <span class="text-sm font-medium text-success">+8.2%</span>
      </div>
      <h3 class="text-2xl font-semibold text-gray-900 mb-1">1,234</h3>
      <p class="text-secondary text-sm">Total Reviews</p>
    </div>
    
    <div class="card p-6">
      <div class="flex items-center justify-between mb-4">
        <div class="w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-users text-warning text-lg"></i>
        </div>
        <span class="text-sm font-medium text-success">+15.3%</span>
      </div>
      <h3 class="text-2xl font-semibold text-gray-900 mb-1">2,847</h3>
      <p class="text-secondary text-sm">Active Customers</p>
    </div>
    
    <div class="card p-6">
      <div class="flex items-center justify-between mb-4">
        <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-thumbs-up text-purple-600 text-lg"></i>
        </div>
        <span class="text-sm font-medium text-success">Perfect</span>
      </div>
      <h3 class="text-2xl font-semibold text-gray-900 mb-1">98%</h3>
      <p class="text-secondary text-sm">Satisfaction</p>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    
    <!-- Profile Information -->
    <div class="lg:col-span-2 card p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-xl font-semibold text-gray-900">Profile Information</h2>
        <button class="btn-secondary text-sm">
          <i class="fas fa-edit mr-2"></i>Edit Profile
        </button>
      </div>
      
      <div class="grid md:grid-cols-2 gap-4">
        <div class="p-4 bg-gray-50 rounded-lg">
          <div class="flex items-center mb-3">
            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
              <i class="fas fa-user text-primary text-sm"></i>
            </div>
            <h3 class="font-medium text-gray-900">Full Name</h3>
          </div>
          <p class="text-gray-700">{{ current_user.first_name }} {{ current_user.last_name }}</p>
        </div>

        <div class="p-4 bg-gray-50 rounded-lg">
          <div class="flex items-center mb-3">
            <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
              <i class="fas fa-building text-success text-sm"></i>
            </div>
            <h3 class="font-medium text-gray-900">Business</h3>
          </div>
          <p class="text-gray-700">{{ current_user.business }}</p>
        </div>

        <div class="p-4 bg-gray-50 rounded-lg">
          <div class="flex items-center mb-3">
            <div class="w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center mr-3">
              <i class="fas fa-envelope text-red-500 text-sm"></i>
            </div>
            <h3 class="font-medium text-gray-900">Email</h3>
          </div>
          <p class="text-gray-700">{{ current_user.email }}</p>
        </div>

        <div class="p-4 bg-gray-50 rounded-lg">
          <div class="flex items-center mb-3">
            <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
              <i class="fas fa-shield-alt text-success text-sm"></i>
            </div>
            <h3 class="font-medium text-gray-900">Status</h3>
          </div>
          <div class="flex items-center">
            <div class="w-2 h-2 bg-success rounded-full mr-2"></div>
            <p class="text-success font-medium">Active & Verified</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Recent Activity -->
    <div class="card p-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-6">Recent Activity</h2>
      
      <div class="space-y-4">
        <div class="flex items-center p-3 bg-gray-50 rounded-lg">
          <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3">
            <i class="fas fa-check text-success text-sm"></i>
          </div>
          <div>
            <p class="font-medium text-gray-900">Profile Updated</p>
            <p class="text-secondary text-sm">2 minutes ago</p>
          </div>
        </div>
        
        <div class="flex items-center p-3 bg-gray-50 rounded-lg">
          <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
            <i class="fas fa-sign-in-alt text-primary text-sm"></i>
          </div>
          <div>
            <p class="font-medium text-gray-900">Successful Login</p>
            <p class="text-secondary text-sm">15 minutes ago</p>
          </div>
        </div>
        
        <div class="flex items-center p-3 bg-gray-50 rounded-lg">
          <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center mr-3">
            <i class="fas fa-star text-warning text-sm"></i>
          </div>
          <div>
            <p class="font-medium text-gray-900">New Review Received</p>
            <p class="text-secondary text-sm">1 hour ago</p>
          </div>
        </div>
      </div>
      
      <button class="w-full mt-6 btn-secondary py-2">
        <i class="fas fa-history mr-2"></i>View All Activity
      </button>
    </div>
  </div>

  <!-- Business Overview -->
  <div class="card p-6">
    <h2 class="text-xl font-semibold text-gray-900 mb-6">Business Review Management</h2>
    
    {% if business_settings %}
    <div class="space-y-6">
      <div class="p-6 bg-blue-50 rounded-lg border border-blue-200">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center space-x-4">
            <div class="w-12 h-12 bg-primary rounded-lg flex items-center justify-center">
              <i class="fas fa-store text-white text-lg"></i>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-gray-900">{{ business_settings.business_name }}</h3>
              <p class="text-secondary">Review management is active</p>
            </div>
          </div>
          <div class="flex items-center space-x-2">
            <div class="w-2 h-2 bg-success rounded-full"></div>
            <span class="text-success font-medium text-sm">Active</span>
          </div>
        </div>
        
        <div class="bg-white rounded-lg p-4 mb-4">
          <div class="flex items-center justify-between mb-2">
            <label class="font-medium text-gray-900 flex items-center">
              <i class="fas fa-link mr-2 text-primary"></i>
              Your Custom Review Form Link
            </label>
            <button type="button" onclick="copyToClipboard('{{ request.url_root }}review-form/{{ business_settings.id }}')" 
                    class="btn-primary text-sm px-4 py-2">
              <i class="fas fa-copy mr-2"></i>Copy Link
            </button>
          </div>
          <code class="text-sm text-gray-600 break-all block bg-gray-100 p-2 rounded">
            {{ request.url_root }}review-form/{{ business_settings.id }}
          </code>
        </div>
        
        <p class="text-secondary text-sm mb-4">
          <i class="fas fa-info-circle mr-1 text-primary"></i>
          Share this link with customers. Reviews with 4+ stars redirect to Google, lower ratings are kept private for improvement.
        </p>
        
        <div class="flex flex-col sm:flex-row gap-3">
          <a href="{{ url_for('view_reviews') }}" 
             class="flex-1 btn-primary text-center py-3">
            <i class="fas fa-chart-bar mr-2"></i>View Reviews Dashboard
          </a>
          <a href="{{ url_for('business_settings') }}" 
             class="flex-1 btn-secondary text-center py-3">
            <i class="fas fa-cog mr-2"></i>Edit Settings
          </a>
        </div>
      </div>
    </div>
    {% else %}
    <div class="text-center p-8 bg-yellow-50 rounded-lg border border-yellow-200">
      <div class="w-16 h-16 bg-warning rounded-lg flex items-center justify-center mx-auto mb-4">
        <i class="fas fa-exclamation-triangle text-white text-xl"></i>
      </div>
      <h3 class="text-lg font-semibold text-gray-900 mb-2">Setup Required</h3>
      <p class="text-secondary mb-6">Configure your business settings to start collecting and managing reviews</p>
      <a href="{{ url_for('business_settings') }}" 
         class="btn-primary text-lg px-8 py-3">
        <i class="fas fa-rocket mr-2"></i>Get Started
      </a>
    </div>
    {% endif %}
  </div>

  <!-- Quick Actions -->
  <div class="card p-6">
    <h2 class="text-xl font-semibold text-gray-900 mb-6">Quick Actions</h2>
    
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
      <a href="{{ url_for('business_settings') }}" class="p-4 text-center bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
        <div class="w-10 h-10 bg-primary rounded-lg flex items-center justify-center mx-auto mb-3">
          <i class="fas fa-store text-white"></i>
        </div>
        <p class="font-medium text-gray-900 text-sm">Business Settings</p>
      </a>
      
      <button class="p-4 text-center bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
        <div class="w-10 h-10 bg-success rounded-lg flex items-center justify-center mx-auto mb-3">
          <i class="fas fa-download text-white"></i>
        </div>
        <p class="font-medium text-gray-900 text-sm">Export Data</p>
      </button>
      
      <a href="{{ url_for('view_reviews') }}" class="p-4 text-center bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
        <div class="w-10 h-10 bg-yellow-500 rounded-lg flex items-center justify-center mx-auto mb-3">
          <i class="fas fa-star text-white"></i>
        </div>
        <p class="font-medium text-gray-900 text-sm">Manage Reviews</p>
      </button>
      
      <button class="p-4 text-center bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
        <div class="w-10 h-10 bg-red-500 rounded-lg flex items-center justify-center mx-auto mb-3">
          <i class="fas fa-headset text-white"></i>
        </div>
        <p class="font-medium text-gray-900 text-sm">Support</p>
      </button>
    </div>
  </div>
</div>

<script>
function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(function() {
    const button = event.target.closest('button');
    const originalText = button.innerHTML;
    
    button.classList.remove('btn-primary');
    button.classList.add('bg-success', 'text-white');
    button.innerHTML = '<i class="fas fa-check mr-2"></i>Copied!';
    
    setTimeout(() => {
      button.innerHTML = originalText;
      button.classList.add('btn-primary');
      button.classList.remove('bg-success', 'text-white');
    }, 2000);
  }).catch(function(err) {
    console.error('Could not copy text: ', err);
  });
}
</script>
{% endblock %}
